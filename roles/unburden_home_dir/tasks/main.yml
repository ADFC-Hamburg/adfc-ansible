---
- name: Include distribution-specific variables
  ansible.builtin.include_vars: "{{ item }}"
  with_first_found:
    - files:
        - "{{ ansible_distribution | lower }}-{{ ansible_distribution_major_version }}.yml"
        - "{{ ansible_distribution | lower }}.yml"
        - "default.yml"
      paths:
        - "{{ role_path }}/vars"

- name: Install Package
  ansible.builtin.include_tasks: install-{{ unburden_home_dir_install_method }}.yml
  tags: unburden

- name: Copy Config Files
  ansible.builtin.copy:
    src: "{{ item }}"
    dest: /etc/
    mode: 0644
    owner: root
    group: root
  with_items:
    - unburden-home-dir
    - unburden-home-dir.list
  tags: unburden

- name: Enable unburden
  ansible.builtin.lineinfile:
    path: /etc/default/unburden-home-dir
    regexp: UNBURDEN_HOME
    line: UNBURDEN_HOME=true
    insertafter: EOF
    create: true
    mode: "0644"
    owner: root
    group: root
  tags: unburden
